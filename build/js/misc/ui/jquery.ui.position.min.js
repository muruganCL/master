!function(t){t.ui=t.ui||{};var e=/left|center|right/,o=/top|center|bottom/,i=t.fn.position,n=t.fn.offset;t.fn.position=function(n){if(!n||!n.of)return i.apply(this,arguments);n=t.extend({},n);var l,f,s,r=t(n.of),c=r[0],a=(n.collision||"flip").split(" "),h=n.offset?n.offset.split(" "):[0,0];return 9===c.nodeType?(l=r.width(),f=r.height(),s={top:0,left:0}):c.setTimeout?(l=r.width(),f=r.height(),s={top:r.scrollTop(),left:r.scrollLeft()}):c.preventDefault?(n.at="left top",l=f=0,s={top:n.of.pageY,left:n.of.pageX}):(l=r.outerWidth(),f=r.outerHeight(),s=r.offset()),t.each(["my","at"],function(){var t=(n[this]||"").split(" ");1===t.length&&(t=e.test(t[0])?t.concat(["center"]):o.test(t[0])?["center"].concat(t):["center","center"]),t[0]=e.test(t[0])?t[0]:"center",t[1]=o.test(t[1])?t[1]:"center",n[this]=t}),1===a.length&&(a[1]=a[0]),h[0]=parseInt(h[0],10)||0,1===h.length&&(h[1]=h[0]),h[1]=parseInt(h[1],10)||0,"right"===n.at[0]?s.left+=l:"center"===n.at[0]&&(s.left+=l/2),"bottom"===n.at[1]?s.top+=f:"center"===n.at[1]&&(s.top+=f/2),s.left+=h[0],s.top+=h[1],this.each(function(){var e,o=t(this),i=o.outerWidth(),r=o.outerHeight(),c=parseInt(t.curCSS(this,"marginLeft",!0))||0,p=parseInt(t.curCSS(this,"marginTop",!0))||0,u=i+c+parseInt(t.curCSS(this,"marginRight",!0))||0,g=r+p+parseInt(t.curCSS(this,"marginBottom",!0))||0,m=t.extend({},s);"right"===n.my[0]?m.left-=i:"center"===n.my[0]&&(m.left-=i/2),"bottom"===n.my[1]?m.top-=r:"center"===n.my[1]&&(m.top-=r/2),m.left=Math.round(m.left),m.top=Math.round(m.top),e={left:m.left-c,top:m.top-p},t.each(["left","top"],function(o,s){t.ui.position[a[o]]&&t.ui.position[a[o]][s](m,{targetWidth:l,targetHeight:f,elemWidth:i,elemHeight:r,collisionPosition:e,collisionWidth:u,collisionHeight:g,offset:h,my:n.my,at:n.at})}),t.fn.bgiframe&&o.bgiframe(),o.offset(t.extend(m,{using:n.using}))})},t.ui.position={fit:{left:function(e,o){var i=t(window);i=o.collisionPosition.left+o.collisionWidth-i.width()-i.scrollLeft(),e.left=i>0?e.left-i:Math.max(e.left-o.collisionPosition.left,e.left)},top:function(e,o){var i=t(window);i=o.collisionPosition.top+o.collisionHeight-i.height()-i.scrollTop(),e.top=i>0?e.top-i:Math.max(e.top-o.collisionPosition.top,e.top)}},flip:{left:function(e,o){if("center"!==o.at[0]){var i=t(window);i=o.collisionPosition.left+o.collisionWidth-i.width()-i.scrollLeft();var n="left"===o.my[0]?-o.elemWidth:"right"===o.my[0]?o.elemWidth:0,l="left"===o.at[0]?o.targetWidth:-o.targetWidth,f=-2*o.offset[0];e.left+=o.collisionPosition.left<0?n+l+f:i>0?n+l+f:0}},top:function(e,o){if("center"!==o.at[1]){var i=t(window);i=o.collisionPosition.top+o.collisionHeight-i.height()-i.scrollTop();var n="top"===o.my[1]?-o.elemHeight:"bottom"===o.my[1]?o.elemHeight:0,l="top"===o.at[1]?o.targetHeight:-o.targetHeight,f=-2*o.offset[1];e.top+=o.collisionPosition.top<0?n+l+f:i>0?n+l+f:0}}}},t.offset.setOffset||(t.offset.setOffset=function(e,o){/static/.test(t.curCSS(e,"position"))&&(e.style.position="relative");var i=t(e),n=i.offset(),l=parseInt(t.curCSS(e,"top",!0),10)||0,f=parseInt(t.curCSS(e,"left",!0),10)||0;n={top:o.top-n.top+l,left:o.left-n.left+f},"using"in o?o.using.call(e,n):i.css(n)},t.fn.offset=function(e){var o=this[0];return o&&o.ownerDocument?e?this.each(function(){t.offset.setOffset(this,e)}):n.call(this):null})}(jQuery);
!function(r){"use strict";Drupal.behaviors.webform=Drupal.behaviors.webform||{},Drupal.behaviors.webform.attach=function(r){Drupal.webform.datepicker(r),Drupal.settings.webform&&Drupal.settings.webform.conditionals&&Drupal.webform.conditional(r)},Drupal.webform=Drupal.webform||{},Drupal.webform.datepicker=function(e){r("div.webform-datepicker").each(function(){var e=r(this),a=e.find("input.webform-calendar");if(0!=a.length){var t=a[0].className.replace(/.*webform-calendar-start-(\d{4}-\d{2}-\d{2}).*/,"$1").split("-"),o=a[0].className.replace(/.*webform-calendar-end-(\d{4}-\d{2}-\d{2}).*/,"$1").split("-"),n=a[0].className.replace(/.*webform-calendar-day-(\d).*/,"$1");if(t=new Date(t[0],t[1]-1,t[2]),o=new Date(o[0],o[1]-1,o[2]),t>o){var i=t;t=o,o=i}var l=t.getFullYear(),u=o.getFullYear();a.datepicker({dateFormat:"yy-mm-dd",yearRange:l+":"+u,firstDay:parseInt(n),minDate:t,maxDate:o,onSelect:function(r,a){var t=r.split("-");e.find("select.year, input.year").val(+t[0]).trigger("change"),e.find("select.month").val(+t[1]).trigger("change"),e.find("select.day").val(+t[2]).trigger("change")},beforeShow:function(a,t){var o=e.find("select.year, input.year").val(),n=e.find("select.month").val(),i=e.find("select.day").val(),f=new Date;o=o?o:f.getFullYear(),n=n?n:f.getMonth()+1,i=i?i:f.getDate(),o=l>o||o>u?l:o,r(a).val(o+"-"+n+"-"+i)}}),a.click(function(e){r(this).focus(),e.preventDefault()})}})},Drupal.webform.conditional=function(e){r.each(Drupal.settings.webform.conditionals,function(e,a){var t=r("."+e+":not(.webform-conditional-processed)");t.each(function(e,o){var n=r(o);n.addClass("webform-conditional-processed"),n.bind("change",{settings:a},Drupal.webform.conditionalCheck),Drupal.webform.doConditions(t,a)})})},Drupal.webform.conditionalCheck=function(e){var a=r(e.target).closest(".webform-component"),t=a.closest("form"),o=a.attr("class").match(/webform-component--[^ ]+/)[0],n=e.data.settings;n.sourceMap[o]&&Drupal.webform.doConditions(t,n)},Drupal.webform.doConditions=function(e,a){var t=[];r.each(a.ruleGroups,function(o,n){var i=a.ruleGroups[o],l=!0,u=[];r.each(i.rules,function(r,t){var o=t.source,n=e.find("."+o)[0],i=a.values[o]?a.values[o]:null;u.push(window.Drupal.webform[t.callback](n,i,t.value))});for(var f=[],p=0;p<u.length;p++)u[p]&&f.push(u[p]);l="or"===i.andor?f.length>0:f.length===u.length,r.each(i.actions,function(a,o){var n=e.find("."+o.target),i=o.invert?!l:l;switch(o.action){case"show":if(i!=Drupal.webform.isVisible(n)){var u=i?n.find(".webform-conditional-disabled").removeClass("webform-conditional-disabled"):n.find(":input").addClass("webform-conditional-disabled");u.webformProp("disabled",!i),n.toggleClass("webform-conditional-hidden",!i),i?n.show():(n.hide(),t[o.target]="hide")}break;case"require":var f=n.find(".form-required, .form-optional").first();if(i!=f.hasClass("form-required")){var p=n.find("input:text,textarea,input[type='email'],select,input:radio,input:file");Drupal.detachBehaviors(f),p.webformProp("required",i).toggleClass("required",i),i?f.replaceWith('<span class="form-required" title="'+Drupal.t("This field is required.")+'">*</span>'):f.replaceWith('<span class="form-optional"></span>'),Drupal.attachBehaviors(f)}break;case"set":var c=t[o.target],s=n.find("input:text,textarea,input[type='email']"),m=n.find("select,select option,input:radio,input:checkbox"),d=n.filter(".webform-component-markup");if(i){var b=r.map(o.argument.split(","),r.trim);m.webformVal(b),s.val([o.argument]),d.html(o.argument)}else d.each(function(){var e=r(this),a=e.data("webform-markup");void 0!==a&&e.html(a)});c||(m.webformProp("disabled",i),s.webformProp("readonly",i),t[o.target]=i?"set":!1)}})})},Drupal.webform.stopEvent=function(){return!1},Drupal.webform.conditionalOperatorStringEqual=function(e,a,t){var o=!1,n=Drupal.webform.stringValue(e,a);return r.each(n,function(r,e){return e.toLowerCase()===t.toLowerCase()?(o=!0,!1):void 0}),o},Drupal.webform.conditionalOperatorStringNotEqual=function(e,a,t){var o=!1,n=Drupal.webform.stringValue(e,a);return r.each(n,function(r,e){e.toLowerCase()===t.toLowerCase()&&(o=!0)}),!o},Drupal.webform.conditionalOperatorStringContains=function(e,a,t){var o=!1,n=Drupal.webform.stringValue(e,a);return r.each(n,function(r,e){return e.toLowerCase().indexOf(t.toLowerCase())>-1?(o=!0,!1):void 0}),o},Drupal.webform.conditionalOperatorStringDoesNotContain=function(e,a,t){var o=!1,n=Drupal.webform.stringValue(e,a);return r.each(n,function(r,e){e.toLowerCase().indexOf(t.toLowerCase())>-1&&(o=!0)}),!o},Drupal.webform.conditionalOperatorStringBeginsWith=function(e,a,t){var o=!1,n=Drupal.webform.stringValue(e,a);return r.each(n,function(r,e){return 0===e.toLowerCase().indexOf(t.toLowerCase())?(o=!0,!1):void 0}),o},Drupal.webform.conditionalOperatorStringEndsWith=function(e,a,t){var o=!1,n=Drupal.webform.stringValue(e,a);return r.each(n,function(r,e){return e.toLowerCase().lastIndexOf(t.toLowerCase())===e.length-t.length?(o=!0,!1):void 0}),o},Drupal.webform.conditionalOperatorStringEmpty=function(e,a,t){var o=Drupal.webform.stringValue(e,a),n=!0;return r.each(o,function(r,e){return""!==e?(n=!1,!1):void 0}),n},Drupal.webform.conditionalOperatorStringNotEmpty=function(r,e,a){return!Drupal.webform.conditionalOperatorStringEmpty(r,e,a)},Drupal.webform.conditionalOperatorSelectGreaterThan=function(r,e,a){var t=Drupal.webform.stringValue(r,e);return Drupal.webform.compare_select(t[0],a,r)>0},Drupal.webform.conditionalOperatorSelectGreaterThanEqual=function(r,e,a){var t=Drupal.webform.stringValue(r,e),o=Drupal.webform.compare_select(t[0],a,r);return o>0||0===o},Drupal.webform.conditionalOperatorSelectLessThan=function(r,e,a){var t=Drupal.webform.stringValue(r,e);return Drupal.webform.compare_select(t[0],a,r)<0},Drupal.webform.conditionalOperatorSelectLessThanEqual=function(r,e,a){var t=Drupal.webform.stringValue(r,e),o=Drupal.webform.compare_select(t[0],a,r);return 0>o||0===o},Drupal.webform.conditionalOperatorNumericEqual=function(r,e,a){var t=Drupal.webform.stringValue(r,e),o=1e-6;return""===t[0]?!1:Math.abs(parseFloat(t[0])-parseFloat(a))<o},Drupal.webform.conditionalOperatorNumericNotEqual=function(r,e,a){var t=Drupal.webform.stringValue(r,e),o=1e-6;return""===t[0]?!0:Math.abs(parseFloat(t[0])-parseFloat(a))>=o},Drupal.webform.conditionalOperatorNumericGreaterThan=function(r,e,a){var t=Drupal.webform.stringValue(r,e);return parseFloat(t[0])>parseFloat(a)},Drupal.webform.conditionalOperatorNumericGreaterThanEqual=function(r,e,a){return Drupal.webform.conditionalOperatorNumericGreaterThan(r,e,a)||Drupal.webform.conditionalOperatorNumericEqual(r,e,a)},Drupal.webform.conditionalOperatorNumericLessThan=function(r,e,a){var t=Drupal.webform.stringValue(r,e);return parseFloat(t[0])<parseFloat(a)},Drupal.webform.conditionalOperatorNumericLessThanEqual=function(r,e,a){return Drupal.webform.conditionalOperatorNumericLessThan(r,e,a)||Drupal.webform.conditionalOperatorNumericEqual(r,e,a)},Drupal.webform.conditionalOperatorDateEqual=function(r,e,a){var t=Drupal.webform.dateValue(r,e);return t===a},Drupal.webform.conditionalOperatorDateNotEqual=function(r,e,a){return!Drupal.webform.conditionalOperatorDateEqual(r,e,a)},Drupal.webform.conditionalOperatorDateBefore=function(r,e,a){var t=Drupal.webform.dateValue(r,e);return t!==!1&&a>t},Drupal.webform.conditionalOperatorDateBeforeEqual=function(r,e,a){var t=Drupal.webform.dateValue(r,e);return t!==!1&&(a>t||t===a)},Drupal.webform.conditionalOperatorDateAfter=function(r,e,a){var t=Drupal.webform.dateValue(r,e);return t!==!1&&t>a},Drupal.webform.conditionalOperatorDateAfterEqual=function(r,e,a){var t=Drupal.webform.dateValue(r,e);return t!==!1&&(t>a||t===a)},Drupal.webform.conditionalOperatorTimeEqual=function(r,e,a){var t=Drupal.webform.timeValue(r,e);return t===a},Drupal.webform.conditionalOperatorTimeNotEqual=function(r,e,a){return!Drupal.webform.conditionalOperatorTimeEqual(r,e,a)},Drupal.webform.conditionalOperatorTimeBefore=function(r,e,a){var t=Drupal.webform.timeValue(r,e);return t!==!1&&a>t},Drupal.webform.conditionalOperatorTimeBeforeEqual=function(r,e,a){var t=Drupal.webform.timeValue(r,e);return t!==!1&&(a>t||t===a)},Drupal.webform.conditionalOperatorTimeAfter=function(r,e,a){var t=Drupal.webform.timeValue(r,e);return t!==!1&&t>a},Drupal.webform.conditionalOperatorTimeAfterEqual=function(r,e,a){var t=Drupal.webform.timeValue(r,e);return t!==!1&&(t>a||t===a)},Drupal.webform.compare_select=function(e,a,t){var o=[];r("option,input:radio,input:checkbox",t).each(function(){o.push(r(this).val())});var n=o.indexOf(e),i=o.indexOf(a);return 0>n||0>i?null:n-i},Drupal.webform.isVisible=function(r){return r.hasClass("webform-component-hidden")?!r.find("input").first().hasClass("webform-conditional-disabled"):0==r.closest(".webform-conditional-hidden").length},Drupal.webform.stringValue=function(e,a){var t=[];if(e){var o=r(e);if(Drupal.webform.isVisible(o)){if(o.find("input[type=checkbox]:checked,input[type=radio]:checked").each(function(){t.push(this.value)}),!t.length){var n=o.find("select").val();n&&(r.isArray(n)?t=n:t.push(n))}t.length||o.find("input:not([type=checkbox],[type=radio]),textarea").each(function(){t.push(this.value)})}}else switch(r.type(a)){case"array":t=a;break;case"string":t.push(a)}return t},Drupal.webform.dateValue=function(e,a){var t=!1;if(e){var o=r(e);if(Drupal.webform.isVisible(o)){var n=o.find("[name*=day]").val(),i=o.find("[name*=month]").val(),l=o.find("[name*=year]").val();i&&i--,""!==l&&""!==i&&""!==n&&(t=Date.UTC(l,i,n)/1e3)}}else"array"===r.type(a)&&a.length&&(a=a[0]),"string"===r.type(a)&&(a=a.split("-")),3===a.length&&(t=Date.UTC(a[0],a[1],a[2])/1e3);return t},Drupal.webform.timeValue=function(e,a){var t=!1;if(e){var o=r(e);if(Drupal.webform.isVisible(o)){var n=o.find("[name*=hour]").val(),i=o.find("[name*=minute]").val(),l=o.find("[name*=ampm]:checked").val();n=""===n?n:parseInt(n),i=""===i?i:parseInt(i),""!==n&&(n=12>n&&"pm"==l?n+12:n,n=12===n&&"am"==l?0:n),""!==n&&""!==i&&(t=Date.UTC(1970,0,1,n,i)/1e3)}}else"array"===r.type(a)&&a.length&&(a=a[0]),"string"===r.type(a)&&(a=a.split(":")),a.length>=2&&(t=Date.UTC(1970,0,1,a[0],a[1])/1e3);return t},r.fn.webformProp=r.fn.webformProp||function(e,a){return a?r.fn.prop?this.prop(e,!0):this.attr(e,!0):r.fn.prop?this.prop(e,!1):this.removeAttr(e)},r.fn.webformVal=function(e){return this.each(function(){var a=r(this),t=a.val(),o=-1!=r.inArray(a.val(),e);"OPTION"==this.nodeName?a.webformProp("selected",o?t:!1):a.val(o?[t]:!1)}),this}}(jQuery);
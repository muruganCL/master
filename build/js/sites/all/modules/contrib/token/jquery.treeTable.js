!function(e){function n(e){for(var n=[];e=d(e);)n[n.length]=e[0];return n}function t(n){return e(n).siblings("tr."+r.childPrefix+n[0].id)}function i(e){var n=parseInt(e[0].style.paddingLeft,10);return isNaN(n)?c:n}function s(n,a){var l=e(n.children("td")[r.treeColumn]);l[0].style.paddingLeft=i(l)+a+"px",t(n).each(function(){s(e(this),a)})}function a(n){if(!n.hasClass("initialized")){n.addClass("initialized");var s=t(n);if(!n.hasClass("parent")&&s.length>0&&n.addClass("parent"),n.hasClass("parent")){var a=e(n.children("td")[r.treeColumn]),l=i(a)+r.indent;s.each(function(){e(this).children("td")[r.treeColumn].style.paddingLeft=l+"px"}),r.expandable&&(a.prepend('<span style="margin-left: -'+r.indent+"px; padding-left: "+r.indent+'px" class="expander"></span>'),e(a[0].firstChild).click(function(){n.toggleBranch()}),r.clickableNodeNames&&(a[0].style.cursor="pointer",e(a).click(function(e){"expander"!=e.target.className&&n.toggleBranch()})),n.hasClass("expanded")||n.hasClass("collapsed")||n.addClass(r.initialState),n.hasClass("expanded")&&n.expand())}}}function l(n,i){n.insertAfter(i),t(n).reverse().each(function(){l(e(this),n[0])})}function d(n){var t=n[0].className.split(" ");for(key in t)if(t[key].match(r.childPrefix))return e(n).siblings("#"+t[key].substring(r.childPrefix.length))}var r,c;e.fn.treeTable=function(n){return r=e.extend({},e.fn.treeTable.defaults,n),this.each(function(){e(this).addClass("treeTable").find("tbody tr").each(function(){r.expandable&&-1!=e(this)[0].className.search(r.childPrefix)?"collapsed"==r.initialState&&(this.style.display="none"):(isNaN(c)&&(c=parseInt(e(e(this).children("td")[r.treeColumn]).css("padding-left"),10)),a(e(this)))})})},e.fn.treeTable.defaults={childPrefix:"child-of-",clickableNodeNames:!1,expandable:!0,indent:19,initialState:"collapsed",treeColumn:0},e.fn.collapse=function(){return e(this).addClass("collapsed"),t(e(this)).each(function(){e(this).hasClass("collapsed")||e(this).collapse(),this.style.display="none"}),this},e.fn.expand=function(){return e(this).removeClass("collapsed").addClass("expanded"),t(e(this)).each(function(){a(e(this)),e(this).is(".expanded.parent")&&e(this).expand(),e(this).show()}),this},e.fn.reveal=function(){return e(n(e(this)).reverse()).each(function(){a(e(this)),e(this).expand().show()}),this},e.fn.appendBranchTo=function(t){var i=e(this),a=d(i),c=e.map(n(e(t)),function(e){return e.id});return-1!=e.inArray(i[0].id,c)||a&&t.id==a[0].id||t.id==i[0].id||(s(i,n(i).length*r.indent*-1),a&&i.removeClass(r.childPrefix+a[0].id),i.addClass(r.childPrefix+t.id),l(i,t),s(i,n(i).length*r.indent)),this},e.fn.reverse=function(){return this.pushStack(this.get().reverse(),arguments)},e.fn.toggleBranch=function(){return e(this).hasClass("collapsed")?e(this).expand():e(this).removeClass("expanded").collapse(),this}}(jQuery);
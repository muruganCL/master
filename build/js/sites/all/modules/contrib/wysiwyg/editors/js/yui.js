!function(t){Drupal.wysiwyg.editor.attach.yui=function(i,e,n){if(t("#"+e.field).parent().addClass("yui-skin-"+n.theme),Drupal.settings.wysiwyg.plugins[e.format])for(var r in Drupal.settings.wysiwyg.plugins[e.format].drupal)n.extracss+=n.extracss+' @import "'+Drupal.settings.wysiwyg.plugins[e.format].drupal[r].css+'"; ';var s=new YAHOO.widget.Editor(e.field,n);s.on("toolbarLoaded",function(){if(Drupal.settings.wysiwyg.plugins[e.format])for(var t in Drupal.settings.wysiwyg.plugins[e.format].drupal)Drupal.wysiwyg.instances[e.field].addPlugin(t,Drupal.settings.wysiwyg.plugins[e.format].drupal[t],Drupal.settings.wysiwyg.plugins.drupal[t])});var a=s.setEditorHTML;s.setEditorHTML=function(t){if(Drupal.settings.wysiwyg.plugins[e.format])for(var i in Drupal.settings.wysiwyg.plugins[e.format].drupal){var n=Drupal.settings.wysiwyg.plugins.drupal[i];"function"==typeof Drupal.wysiwyg.plugins[i].attach&&(t=Drupal.wysiwyg.plugins[i].attach(t,n,e.field),t=Drupal.wysiwyg.instances[e.field].prepareContent(t))}a.call(this,t)};var o=s.getEditorHTML;s.getEditorHTML=function(){var t=o.call(this);if(Drupal.settings.wysiwyg.plugins[e.format])for(var i in Drupal.settings.wysiwyg.plugins[e.format].drupal){var n=Drupal.settings.wysiwyg.plugins.drupal[i];"function"==typeof Drupal.wysiwyg.plugins[i].detach&&(t=Drupal.wysiwyg.plugins[i].detach(t,n,e.field))}return t},s.on("editorContentLoaded",function(t){t.target.setEditorHTML(o.call(t.target))}),s.on("afterNodeChange",function(t){if(Drupal.settings.wysiwyg.plugins[e.format])for(var i in Drupal.settings.wysiwyg.plugins[e.format].drupal)"function"==typeof Drupal.wysiwyg.plugins[i].isNode&&Drupal.wysiwyg.plugins[i].isNode(t.target._getSelectedElement())&&this.toolbar.selectButton(i)}),s.render()},Drupal.wysiwyg.editor.detach.yui=function(t,i,e){var n=e&&"serialize"==e?"saveHTML":"destroy";if("undefined"!=typeof i){var r=YAHOO.widget.EditorInfo._instances[i.field];r&&(r[n](),"destroy"==n&&delete YAHOO.widget.EditorInfo._instances[i.field])}else for(var s in YAHOO.widget.EditorInfo._instances){var r=YAHOO.widget.EditorInfo._instances[s];r[n](),"destroy"==n&&delete YAHOO.widget.EditorInfo._instances[s]}},Drupal.wysiwyg.editor.instance.yui={addPlugin:function(i,e,n){if("object"==typeof Drupal.wysiwyg.plugins[i]){var r=YAHOO.widget.EditorInfo.getEditorById(this.field),s=r.toolbar.getButtonByValue(i);t(s._button).parent().css("background","transparent url("+e.icon+") no-repeat center");var a=this.field;r.toolbar.on(i+"Click",function(e){var s=r._getSelectedElement(),o={format:"html",node:s,content:t(s).html()};Drupal.wysiwyg.plugins[i].invoke(o,n,a)})}},prepareContent:function(t){var i=YAHOO.widget.EditorInfo.getEditorById(this.field);return t=i.cleanHTML(t)},insert:function(t){YAHOO.widget.EditorInfo.getEditorById(this.field).execCommand("inserthtml",t)},setContent:function(t){YAHOO.widget.EditorInfo.getEditorById(this.field).setEditorHTML(t)},getContent:function(){var t=YAHOO.widget.EditorInfo.getEditorById(this.field);return t.cleanHTML(t.getEditorHTML(content))}}}(jQuery);